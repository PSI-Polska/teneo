<?xml version="1.0" encoding="UTF-8"?>
<!--
	Copyright 2005-2006, Elver.org (http://www.elver.org).

	Licensed under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License.
	You may obtain a copy of the License at

		http://www.apache.org/licenses/LICENSE-2.0

	Unless required by applicable law or agreed to in writing, software
	distributed under the License is distributed on an "AS IS" BASIS,
	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	See the License for the specific language governing permissions and
	limitations under the License.
-->

<!--
	@author <a href="mtaal@elver.org">Martin Taal</a>
	@version $Revision: 1.1 $ $Date: 2006/08/03 09:58:09 $
-->

<!DOCTYPE document PUBLIC
	"-//APACHE//DTD Documentation V2.0//EN"
	"http://forrest.apache.org/dtd/document-v20.dtd">

<document> 
	<header> 
		<title>Step 4: Example Queries</title> 
	</header> 
	<body>
		<p>In this part we show Hibernate HSQL queries to retrieve information from the database back-end.</p>
		<p>(HQL is Hibernate's query language. It uses concepts similar to SQL.)</p>
		
		<section>
		<title>Query all books</title>
		<source>
final Session session = sessionFactory.openSession();
session.beginTransaction();

// Retrieve all Books and display their titles.
Query query = session.createQuery("FROM Book");
List books = query.list();
for (Iterator it = books.iterator(); it.hasNext();) {
	Book book = (Book) it.next();
	System.out.println(book.getTitle());
}</source>
			</section>
		
		<section>
		<title>Parameterized query</title>
		<source>
// Retrieve George Orwell's book. 
query = session.createQuery("SELECT book FROM Book book, Writer writ WHERE "
		+ " book.title='1984' AND book.author=writ AND writ.name='G. Orwell'");
books = query.list();

// Show some results
System.out.println("There are " + books.size() + " in the Library."); // should be 1
System.out.println(books.get(0).getClass().getName());
Book book = (Book) books.get(0);
System.out.println(book.getTitle()); // should be 1984
System.out.println(book.getAuthor().getName()); // should be G. Orwell</source>
		</section>
		
		<section>
		<title>Count query</title>
		<source>
// Count the number of books in the library
query = session.createQuery("SELECT count(allbooks) FROM Library lib LEFT JOIN lib.books AS allbooks "
		+ " WHERE lib.name='My Library'");
int count = ((Number) query.uniqueResult()).intValue();
// there should be 2 books
System.out.println("There are " + count + " books in the library");</source>
			</section>
		
	<section>
		<title>Next Step</title>
		<p>The final step of this tutorial discusses the use of the EMF Resource concept.</p>
		<p><a href="tutorial1_5.html">Click here</a> to go to the next step.</p>
	</section>
	</body>
</document>
