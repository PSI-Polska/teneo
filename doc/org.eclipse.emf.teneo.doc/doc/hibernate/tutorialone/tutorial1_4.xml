<?xml version="1.0" encoding="UTF-8"?>
<!--
	Copyright (c) 2005, 2006 Springsite BV (The Netherlands) and others
	All rights reserved. This program and the accompanying materials
	are made available under the terms of the Eclipse Public License v1.0
	which accompanies this distribution, and is available at
	http://www.eclipse.org/legal/epl-v10.html
-->

<!--
	@author <a href="mtaal@elver.org">Martin Taal</a>
	@version $Revision: 1.2 $ $Date: 2006/09/13 10:42:35 $
-->

<!DOCTYPE document PUBLIC
	"-//APACHE//DTD Documentation V2.0//EN"
	"http://forrest.apache.org/dtd/document-v20.dtd">

<document> 
	<header> 
		<title>Step 4: Example Queries</title> 
	</header> 
	<body>
		<p>In this part we show Hibernate HSQL queries to retrieve information from the database back-end.</p>
		<p>(HQL is Hibernate's query language. It uses concepts similar to SQL.)</p>
		
		<section>
		<title>Query all books</title>
		<source>
final Session session = sessionFactory.openSession();
session.beginTransaction();

// Retrieve all Books and display their titles.
Query query = session.createQuery("FROM Book");
List books = query.list();
for (Iterator it = books.iterator(); it.hasNext();) {
	Book book = (Book) it.next();
	System.out.println(book.getTitle());
}</source>
			</section>
		
		<section>
		<title>Parameterized query</title>
		<source>
// Retrieve George Orwell's book. 
query = session.createQuery("SELECT book FROM Book book, Writer writ WHERE "
		+ " book.title='1984' AND book.author=writ AND writ.name='G. Orwell'");
books = query.list();

// Show some results
System.out.println("There are " + books.size() + " in the Library."); // should be 1
System.out.println(books.get(0).getClass().getName());
Book book = (Book) books.get(0);
System.out.println(book.getTitle()); // should be 1984
System.out.println(book.getAuthor().getName()); // should be G. Orwell</source>
		</section>
		
		<section>
		<title>Count query</title>
		<source>
// Count the number of books in the library
query = session.createQuery("SELECT count(allbooks) FROM Library lib LEFT JOIN lib.books AS allbooks "
		+ " WHERE lib.name='My Library'");
int count = ((Number) query.uniqueResult()).intValue();
// there should be 2 books
System.out.println("There are " + count + " books in the library");</source>
			</section>
		
	<section>
		<title>Next Step</title>
		<p>The final step of this tutorial discusses the use of the EMF Resource concept.</p>
		<p><a href="tutorial1_5.html">Click here</a> to go to the next step.</p>
	</section>
	</body>
</document>
