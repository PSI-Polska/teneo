<?xml version="1.0" encoding="UTF-8"?>
<!--
	Copyright (c) 2005, 2006 Springsite BV (The Netherlands) and others
	All rights reserved. This program and the accompanying materials
	are made available under the terms of the Eclipse Public License v1.0
	which accompanies this distribution, and is available at
	http://www.eclipse.org/legal/epl-v10.html
-->

<!--
	@author <a href="mtaal@elver.org">Martin Taal</a>
	@version $Revision: 1.2 $ $Date: 2006/09/13 10:42:34 $
-->

<!DOCTYPE document PUBLIC
	"-//APACHE//DTD Documentation V2.0//EN"
	"http://forrest.apache.org/dtd/document-v20.dtd">

<document> 
	<header> 
		<title>Inheritance Mapping</title> 
		<abstract>Discusses the supported inheritance mapping strategies</abstract>
	</header> 
	<body>
		<section><title>Supported inheritance mapping strategies</title>
		<p>The Teneo OR Mapper supports two of the three inheritance mapping of Hibernate
			(see <a href="http://www.hibernate.org/hib_docs/v3/reference/en/html/inheritance.html">
			chapter 9</a> of the Hibernate manual):</p>
		<ul>
		<li>SINGLE_TABLE: Table-per-class-hierarchy, in this scenario the classes of one 
			class hierarchy are all mapped to one table.</li>
		<li>JOINED: Table-per-subclass, in this strategy each subclass will have its own table. To
			retrieve an object from the database the superclass and subclass tables are joined. 
			This also applies to subclasses of subclasses.</li>
		</ul>
		<p>As a default SINGLE_TABLE inheritance mapping is used. There are two methods by which the inheritance mapping
		can be set.</p>
		<ol>
		<li>Globally: pass the constant org.eclipse.emf.teneo.mapper.PersistenceMappingOptions.INHERITANCEMAPPING as a property 
		when initializing a HbDataStore. This property can have two values: SINGLE_TABLE or JOINED.</li>
		<li>By using an (EJB3) annotation for individual types: see below.</li>
		</ol>
		<p>Hibernate has as main limitation that the two approaches above can not be mixed within one
		class hierarchy.</p>
		<p>There is also another way of mapping inheritance structures: MappedSuperclass. In this method the superclass
		is not persisted by itself and does not have its own table. All the properties of the superclass are stored in the 
		table(s) of the subclass(es). MappedSuperclass is set by an EJB3-like annotation. For more information see the EJB3 spec.</p> 
		</section>
		<section><title>Specifying inheritance mapping per class hierarchy</title>
		<p>There are cases where it is necessary
		to use different inheritance mapping techniques for different class hierarchy within
		one application or project. This can be achieved by adding specific EJB3-like annotations to the type definition
		(uml or XML Schema).</p>
		<p>As an example see the following type definition of Address which
		sets the inheritance mapping strategy to JOINED (joined subclass) for Address and all
		its subtypes:</p>
				<source><![CDATA[
<xsd:complexType name="Address" abstract="true">
	<xsd:annotation>
		<xsd:appinfo source="teneo.jpa">@Inheritance(strategy=JOINED)</xsd:appinfo>
	</xsd:annotation>
 	<xsd:sequence>
		<xsd:element name="name" type="xsd:string"/>
		<xsd:element name="street" type="xsd:string"/>
		<xsd:element name="city" type="xsd:string"/>
	</xsd:sequence>
</xsd:complexType>
			]]></source>
		<p>The inheritance-mapping annotation can have one of the two following values: JOINED or SINGLE_TABLE.</p>
		<p>The above annotation can also be added in UML. Please use the same values for the 
			source and the key.</p>
		<p><strong>The inheritance annotation has changed, from the 0.3.* to the 0.7.0 release, to an EJB3-like format.</strong></p>
		</section>
		<section><title>Multiple Inheritance Support</title>
		<p>In EMF it is possible to define multiple inheritance structures. However, Hibernate can not handle multiple inheritance.</p>
		<p>Therefore 
		during the mapping the first supertype is considered to be the real parent (for Hibernate). The properties of the 
		other super types are mapped together with the subclass. The other super types will have their own tables in the 
		database but there will be no relations between the subclass table and its other superclass tables.
		</p>
		</section>
		<section><title>Links to Inheritance-Mapping Articles</title>
		<ul>
			<li><a href="http://www.hibernate.org/hib_docs/v3/reference/en/html/inheritance.html">Chapter 9</a>
				of the Hibernate manual</li>
			<li><a href="http://www.ambysoft.com/essays/mappingObjects.html">Mapping Objects To Relational Databases</a>
				by Scott Ambler</li>
		</ul>
		</section>
	</body>
</document>
